/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   main.c                                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: onault <onault@student.42.fr>              +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/03/12 12:24:18 by onault            #+#    #+#             */
/*   Updated: 2024/03/25 16:05:51 by onault           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "push_swap.h"

int	return_bit(int nbr, int pos)
{
	int	i;

	i = 1;
	i = i << (pos - 1);
	if (nbr & i)
		return (1);
	return (0);
}

void	sort_to_b(t_col *cola, t_col *colb, int bit_index)
{
	if (return_bit(cola->c[0], bit_index) == 0)
	{
		printf("pb\n");
		pa_pb(colb, cola);
	}
	else
	{
		ra_rb(cola);
		printf("ra\n");
	}
}

void	main_tri(t_col *cola, t_col *colb)
{
	int	bit_index;
	int	start;
	int	i;

	bit_index = 1;
	i = 0;
	while (is_sorted(cola) == 0 && *colb->sizeofc == 0)
	{
		start = *cola->sizeofc;
		while (start != 0)
		{
			sort_to_b(cola, colb, bit_index);
			start--;
		}
		while (*colb->sizeofc > 0)
		{
			printf("pa\n");
			pa_pb(cola, colb);
		}
		bit_index++;
		i++;
	}
}

int	main(int argc, char *argv[])
{
	t_col	*cola;
	t_col	*colb;

	cola = malloc(sizeof(t_col));
	colb = malloc(sizeof(t_col));
	if (argc == 1)
		return (0);
	if (!cola || !colb || check_arg(argv) == 0)
	{
		write(2, "Error\n", 6);
		free(cola);
		free(colb);
		return (0);
	}
	if (init_col(cola, colb, argc) == 0)
		return (0);
	insert_into_a(cola, argv);
	remove_gap(cola);
	if (*cola->sizeofc > 5)
		main_tri(cola, colb);
	else if (*cola->sizeofc < 6 && *cola->sizeofc > 3)
		five_less(cola, colb);
	else
		three(cola);
	free_col(cola, colb);
}
// 3

// 3 1 2
// 1 2 3
// 2 3 1
// 1 2 3

// 5

//  5 4 3 2 1
// 340 87 135 301 67
// 242 367 283 260 477
// 107 174 481 329 382
// 351 56 283 297 496

// 100

// 47 87 100 77 89 59 83 38 12 29 18 54 65 74 48 15 30 96 40 66 19
// 32 16 73 21 86 27 55 57 93 53 72 91 14 97 35 41 58 34 85 28 31
// 49 37 92 10 1 44 64 7 5 20 94 24 70 50 56 45 9 98 78 4 2 61 8
// 80 90 60 17 67 33 88 71 69 81 3 43 0 68 39 52 75 63 79 26 36 
//13 95 22 84 11 46 51 99 6 62 25 76 23 42

// 59 75 71 36 37 18 63 32 10 95 96 38 72 80 53 12 62 22 15 39 52
// 93 49 89 26 94 77 8 92 30 19 3 85 35 82 74 43 86 99 21 58 16 64
// 20 73 67 0 55 97 28 11 14 66 4 29 33 50 2 81 41 88 17 83 65 6
// 100 98 44 60 34 48 78 13 5 1 27 90 79 57 70 40 84 47 24 76 46 
// 42 31 54 9 51 25 68 61 7 23 91 87 69 56

// 75 17 45 44 6 16 61 34 11 46 76 4 69 90 33 64 91 96 86 5 88 40 92
//  7 1 51 63 47 3 73 52 29 79 30 98 97 37 42 28 66 72 95 71 81 8 84 
//  20 10 55 80 36 77 100 99 21 54 82 41 0 43 56 12 68 49 23 65 59 27 
//  48 31 25 32 9 53 39 
// 18 89 62 60 67 57 22 50 15 87 2 58 38 13 14 35 83 24 78 70 26 19 74 94 93

// 311 235 119 183 426 210 178 150 147 165 188 278 273 258 334 480 312 329 160 

// 500

// 184 155 306 289 134 406 452 228 
// 53 287 229 395 136 95 168 363 222 171 469 231 
// 292 489 277 394 83 351 496 269 322 468 286 27 415 194 383 261 125 447 63 297 
// 317 253 81 143 44 408 493 224 
// 497 282 473 149 434 446 284 391 276 430 304 260 
// 212 96 465 463 120 36 201 482 294 244 76 356 61 266 124 67 10 483 135 7 131 
// 402 207 243 404 431 42 138 239 
// 70 298 403 129 215 362 274 405 367 347 380 400 
// 79 25 13 148 438 251 495 195 193 59 373 275 208 389 309 320 104 343 106 454 
// 285 436 166 460 78 152 310 115 384 321 263 342 69 305 417 470 392 474 449 
// 424 300 393 364 192 375 440 223 486 117 1 144 71 128 416 74 2 48 153 464 34 
// 288 385 187 211 450 252 241 279 272 121 190 89 41 163 141 413 462 181 333 
// 126 435 93 370 418 180 214 146 458 151 113 52 66 118 376 407 154 16 240 
// 340 39 396 354 177 186 428 205 174 459 414 46 80 349 197 28 198 350 477 
// 14 50 114 381 84 453 387 137 371 213 341 8 471 102 86 479 316 122 355 448 
// 110 330 30 433 388 326 72 432 123 442 353 318 85 82 5 179 35 101 22 250 107 
// 26 492 314 204 439 249 344 199 444 133 338 337 358 425 65 491 352 332 487 
// 94 29 161 132 327 379 238 221 139 475 23 17 159 369 97 218 323 73 140 336 
// 293 200 451 315 377 4 38 409 87 256 302 88 217 225 169 368 182 461 281 
// 390 411 18 54 301 45 410 116 397 485 21 77 236 319 421 112 291 412 476 227 
// 75 232 335 423 360 313 127 401 271 20 6 19 37 307 247 324 145 382 290 172 
// 264 167 91 339 398 478 220 328 443 357 419 420 196 92 374 494 500 366 331 
// 108 11 156 296 262 47 103 378 68 308 170 55 490 202 265 33 99 185 346 437 
// 299 105 427 90 233 24 248 219 64 60 40 386 283 456 295 209 472 280 455 242 
// 157 234 9 32 268 56 365 230 203 267 422 303 130 51 226 255 100 259 325 49 
// 237 254 488 189 466 206 162 246 173 270 175 62 484 15 142 429 43 457 245 
// 441 467 12 445 98 498 345 176 361 348 372 164 216 109 3 111 399 0 191 481 
// 257 158 31 359 57 58